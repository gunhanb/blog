<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Burak's Data Blog &middot; 
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/blog/public/css/poole.css">
  <link rel="stylesheet" href="/blog/public/css/syntax.css">
  <link rel="stylesheet" href="/blog/public/css/hyde.css">
  <link rel="stylesheet" href="/blog/public/css/custom.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blogpublic/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/blogpublic/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  <!-- Mathjax -->
  <script type="text/javascript"
            src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    
    <!--Disqus comment counts-->
    <script id="dsq-count-scr" src="//https-gunhanb-github-io-blog.disqus.com/count.js" async></script>
    
</head>


  <body class="theme-base-0b">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/blog">
          Burak's Data Blog
        </a>
      </h1>
      <p class="lead">This is just another blog about statistics, R and data science etc.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/blog">Home</a>

      

      
      
        
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/about.html">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/archive.html">Archives</a>
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/categories.html">Categories</a>
          
        
      
        
          
        
      
      <a class="sidebar-nav-item" href="https://github.com/gunhanb/blog">GitHub project</a>
    </nav>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog//2016/12/08/life-expectancy.html">
        A misunderstanding about life expectancy
      </a>
    </h1>
    
<a href="/blog/2016/12/08/life-expectancy.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">08 Dec 2016</span>

    <p>Here I want to talk about a very common mistake when it comes to <em>life expectancy</em> and its interpretation. In one of my epidemiology courses, the lecturer showed the below Figure.</p>

<p><img src="/figure/source/2016-12-08-life-expectancy/LifeEx.png" alt="" /></p>

<p>I am sure you also see graphs like that not this particular one (I mean for Switzerland) but maybe similar. OK, we see a very clear trend that life expectancy increasing in the last century. It was even doubled, right? That’s very nice. And we also see that there is clear difference between men and women but it is not my issue here.</p>

<p>I am more interested in the increase of the life expectancy. To understand it better first important question is, as always, why. In other words what is the possible <em>explanation</em>. And second question, what can we guess about the life expectancy of 2100 for example, so the <em>prediction</em>. My lecturer gave the answer for the first question: the remarkable achievement of <em>modern medicine</em>. And so by this logic, he said that the life expectancy probably may continue to increase as we had in the last century.</p>

<p>Now, let’s consider not 1900 but long before, for instance think about our ancestors, hunter gatherers. What we expect is that they may have similar (or even low say 30?) life expectancy like 1900, right? So lets think from a hunter gatherer perspective and see this below Figure for this purpose.</p>

<p><img src="/figure/source/2016-12-08-life-expectancy/Foragers.png" alt="" /></p>

<p>Our ancestors did not get it why they could not survive after 30. But the achievements of the medicine fully can explain it?</p>

<p>At this point, to understand better, we need to look at the precise definition of the life expectancy (from Wikipedia):</p>

<blockquote>
  <p>The mean length of life of a hypothetical cohort (all individuals born in a given year) assumed to be exposed since birth until death of all their member to the mortality rate observed at a given year.</p>
</blockquote>

<p>OK, the definition seems unnecessarily complicated, but important point is that life expectancy is just a mean. So it is one type of statistical measure. But to gain more insight about the data maybe it is better to look more than just mean values. Unfortunately, I don’t have the real data, so lets just simulate some data for our purpose and plot it:</p>

<p><img src="/blog/figure/source/2016-12-08-life-expectancy/plot1-1.png" alt="plot of chunk plot1" /></p>

<p>Now in the above Figure, you see all data points (the mean length of life bla bla bla <em>per person</em>) as well as the life expectancy as red crosses (or let’s call it mean values). But the problem is that in reality data do not look like that Figure, but instead more look like the below Figure.</p>

<p><img src="/blog/figure/source/2016-12-08-life-expectancy/plot2-1.png" alt="plot of chunk plot2" /></p>

<p>So lets compare those two Figures which are based on two different simulated datasets. Firstly the red crosses are exactly has the same values (monotonically increasing from a value close to 40 to a value close to 80). That implies mean values are the same. But in the second Figure, there are many data points very close to zero values. But the second set of data points of each given year (values which are far away to zero) seem to not increasing much. So what does that mean?. Those very small data points corresponding to children who died at very early ages (<em>infant mortality</em>). And as you can see, with decreasing of the infant mortality, the mean values are going away from zero even if the adult mortality stays constant.</p>

<p>That means, back then, your expected value of length of life is very low when you are child. But once you reach the adulthood then it is not that low like 30. That’s why even in the times when the life expectancy is 30, you can see many people of high ages like 60.</p>

<p>OK, I exaggerated a little bit to make the point, and of course the advancement of modern medicine (better medications etc.) is a very important explanation of the increase of life expectancy. But still I think considering only the mean values can be misleading since infant mortality has possibly more effect on the increase of life expectancy.</p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog//2016/12/06/confounding.html">
        Confounding or the relationship between shoe size and salary
      </a>
    </h1>
    
<a href="/blog/2016/12/06/confounding.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">06 Dec 2016</span>

    <p>There are few terms in the context of statistics which I find very interesting and powerful when I, first, understand it. One of which is, undoubtedly, the concept of <em>confounding</em>. This term attracted my attention; since, in my opinion, it has potential to explain many mechanisms in different fields when statistical methods are used as tools. As you may imagine, medicine, biology or political science are only some examples for different areas. To explain the confounding, I use following example.</p>

<h1 id="a-simple-example">A simple example</h1>

<p>Now, assume that we want to examine the association between the salary per month of a person who lives in Zurich city and his or her shoe size. Of course, you may think this example is a silly one, but, I believe, by using such an example, one can understand the confounder term very easily. In order to have some data to analyse, you go to city’s most crowded street and collect data by using a questionnaire. Assume that your questionnaire is valid, you asked 1000 people (enough sample size!), so in short your data is <em>reliable</em>. Then you want to plot your data so as to see what is going on in the dataset. So, you decided to use a scatterplot, and you get below figure.</p>

<p><img src="/blog/figure/source/2016-12-06-confounding/plot1-1.png" alt="plot of chunk plot1" /></p>

<p>Moreover, you use simple regression, estimated the regression line and plot it as a superimposed line to the Figure (Of course I did not do any survey, I just simulated data).</p>

<p>Then, you concluded from this Figure as follows:</p>

<blockquote>
  <p>There is a strong association between shoe size and salary per month. With increasing shoe size of a person, his or her salary is increasing.</p>
</blockquote>

<p>So far, everything seems you correct but still we have a weird conclusion, right? You can understand the underlying problem, when you plot the same data but now using different colors for male and female (luckily you have gender information coming from your questionnaire). And you plot two simple regression lines for female and male separately – you estimated those two lines by using two different subset of data. So we obtained the below Figure.</p>

<p><img src="/blog/figure/source/2016-12-06-confounding/plot2-1.png" alt="plot of chunk plot2" /></p>

<p>Now our conclusion is changed completely! The <em>effect</em> vanished, and now we don’t have any evidence suggest that there is an association between shoe size and salary. Our possible conclusion, however, is as follows. Males have substantially larger shoe size than females on average (which has a biological explanation) and also, males has earning more money on average (which is also true indeed). But shoe size has nothing to do with salary for both subset of data! In such a case, <em>gender</em> is a confounding variable which is mixing the effect. In this scenario, we see an effect which is not there, actually. But in other situations, you can see an effect but you may get the direction wrong.</p>

<p>These situations are not an extreme cases, especially if you are working with <em>observational</em> data. Therefore, one should try to eliminate any possible confounders. For example, if you are investigating a health-related issue, age and gender are usual suspects. But at the end of the day, it is very important not to <em>overinterpret</em> the results in case of any confounders.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog//2016/10/27/reproducible-research.html">
        Nasıl "reproducible research" yaparım?
      </a>
    </h1>
    
<a href="/blog/2016/10/27/reproducible-research.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">27 Oct 2016</span>

    <p>Diyelim ki bir arkadaşınız yaklaşık bir sene önce tamamlamış olduğunuz bir <em>research</em> calışmanızdan birşey sordu. Calısmanıza dönüp analizleri tekrar gözden geçirmek, tablo ve figürleri <em>reproduce</em> edebilmeniz ne kadar vaktinizi alacaktır? Veya arkadaşınızı boşverin, sadece kendiniz 2 sene önce hazırlamış olduğunuz sunumdaki <em>result</em>larin tekrar elde etmeye calışsanız? Bu süreyi ve olası zahmeti azaltmanın (ve daha fazlası) metodu <em>reproducible research</em> yapmanız!</p>

<p>Eğer günlük hayattaki calışmalarınızda bir sekilde <em>data analysis</em> yapıyorsaniz, eski yontemler yerine <em>reproducible research</em> kullanmaniz belki biraz daha zahmetli ama uzun vadede kesinlikle daha faydali.</p>

<p>Bir başka açıdan bakacak olursak, geleneksel rapor yazımında, sonuçları bir software de hesaplayip, sonra da hesaplamış oldugumuz sayılari elle sonuç bölümüne yazarız. Ama bu yöntem reproducible değil, data <em>software</em> e bağlı fakat sonuçlar yazdıgımız metne bağlı değil, dolayısıyla hata yapma ihtimali bir hayli yüksek.</p>

<p>Bu konu tabiiki bayağı geniş ve kapsamlı, ayrica niyetim bir <em>manual</em> yazmak değil. Bu yazıda amacım kendi tecrübelerimden faydalanarak tamamen pratik açıdan reproducible research’u kısaca anlatmaya calişmak (<a href="http://reproducibleresearch.net">daha ayrıntılı bilgi için tıklayin</a>). Turkce yazmamın amacı da bu konulardaki Türkçe materyallerin eksikliği.</p>

<p>Ilk olarak data analysis’i hangi <em>software</em> de yapacagim sorusu karsimiza geliyor. Bir istatistikci oldugum icin buna verecegim cevap tabiki <a href="https://www.r-project.org"><strong>R</strong></a> (since <strong>R</strong> is made by statisticians for statisticians!). Ikinci olarak <em>typesetting</em> programimizi belirlememiz gerekiyor, raporu/makaleyi/tezi yazacagimiz veya sunumu hazirlayacagimiz program. Buna cevabimiz ise <em>LaTeX</em> olabilir. Fakat diger guclu bir alternatif ise <a href="https://daringfireball.net/projects/markdown/"><em>Markdown</em></a>. Markdown ile hem pdf, word veya HTML output elde edebiliyoruz. Bu yazida <em>Markdown</em> kullanacagiz, cünkü bize
Ve ucuncu olarak bize uygun bir <em>text editor</em> gerekli, bunun icin de <strong>Rstudio</strong> yu kullaniyoruz. Sonunda sihirli dokunusu yapacak yani reproducible research u mumkun kilacak olan program (aslinda bir <strong>R</strong> <em>package</em>): <strong>knitr</strong>. Tam burada <strong>knitr</strong> in babasi olan programi hatirlatmam gerekiyor, saygi geregi <strong>Sweave</strong>.</p>

<p>Dolayisiyla <strong>knitr</strong> ile birlikte bu uc program, <strong>R</strong> + Markdown + <strong>Rstudio</strong>, bize reproducible research yapabilmemiz icin yeterli ve bu arada hepsi de free software. Kisacasi bir tek <em>document</em> a hem LaTeX kodu hem de <strong>R</strong> kodunu yaziyorsunuz (.Rmd file) ve sonrasinda <em>compile</em> edip PDF inize kavusmus oluyorsunuz. Aslina bakarsaniz, <strong>knitr</strong> kullanarak reproducible research yapabilmemiz icin bu uc programin hicbiri farz degil, alternatif kombinasyonlara en sonda deginecegim. Rstudio nun sagladigi en onemli fayda ise <em>compile to PDF</em> adimini sadece tek bir tusa indirgiyor olusu.</p>

<h2 id="basit-bir-ornek">Basit bir ornek</h2>

<p><em>Base R</em> dan <em>cars</em> adli <em>dataset</em> i kullanacagiz. Bu dataset farkli arabalarin hizlari (<em>speed variable</em>) ve her bir arabanin durmak icin gerekli mesafelerini (<em>dist variable</em>) iceriyor. Bu datayi analiz etmek icin <em>linear regression</em> kullaniyoruz ve gerekli <strong>R</strong> kodu asagidaki gibi gosterebiliriz.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">dist</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">speed</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cars</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">linear</span><span class="w"> </span><span class="n">regression</span><span class="w"> </span></code></pre></figure>

<p>Tabii sonuclari -mesela bu ornekte <em>coefficients</em>- bir tabloda gostermek isteyebiliriz. Bunun icin de <strong>xtable</strong> (bir <strong>R</strong> package) bize yardimci olacak. Asagidaki <strong>R</strong> kodu bize gerekli HTML kodu veriyor, ve compile ettikten sonra da Tablo 1’i elde ediyoruz.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span><span class="w">
</span><span class="n">coefs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="n">coef</span><span class="p">(</span><span class="n">fit</span><span class="p">))</span><span class="w">
</span><span class="n">rownames</span><span class="p">(</span><span class="n">coefs</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Intercept"</span><span class="p">,</span><span class="w"> </span><span class="s2">"speed"</span><span class="p">)</span><span class="w">
</span><span class="n">kable</span><span class="p">(</span><span class="n">coefs</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"tab:coefs"</span><span class="p">,</span><span class="w">
      </span><span class="n">digits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">
      </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> 
      </span><span class="n">col.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Estimate"</span><span class="p">)</span></code></pre></figure>

<table>
  <thead>
    <tr>
      <th style="text-align: left"> </th>
      <th style="text-align: right">Estimate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Intercept</td>
      <td style="text-align: right">-17.58</td>
    </tr>
    <tr>
      <td style="text-align: left">speed</td>
      <td style="text-align: right">3.93</td>
    </tr>
  </tbody>
</table>

<p>Normal sartlarda tabloyu yaratan <strong>R</strong> kodu okuyucuya gostermeye gerek yok fakat ben ornek olmasi acisindan gosteriyorum.</p>

<p>Simdi ise <em>data visualization</em>. Asagidaki <strong>R</strong> kod ile Figure 1’i elde ediyoruz.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">cars</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">speed</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">geom_abline</span><span class="p">(</span><span class="n">intercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coef</span><span class="p">(</span><span class="n">fit</span><span class="p">)[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">slope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coef</span><span class="p">(</span><span class="n">fit</span><span class="p">)[</span><span class="m">2</span><span class="p">])</span></code></pre></figure>

<p><img src="/figure/source/2016-10-27-reproducible-research/figure-1.png" alt="plot of chunk figure" /></p>

<p>Bu ornekte damaginiza <strong>knitr</strong> kullanimindan bir tat calmayi amacladim.</p>

<p>Benim ugrastigim problemlerde <strong>knitr</strong> in saglamis oldugu cok onemli diger bir fayda ise <em>cache</em> ozelligi. Simdi farz edin ki analiziniz yukaridaki gibi bir simple linear regression degil, mesela simulasyon yapiyorsunuz veya <em>bootstrapping</em>. Dolayisiyla islem saatler surebilir. Bu durumda <strong>knitr</strong> in cache ozelligini kullanabilirsiniz, ilk compilation da analiz yapilir (artik ne kadar suruyorsa) ve <strong>knitr</strong> sizin icin outputu kaydeder. Sonraki compilationlarda ise knitr kaydedilmis outputu kullanir!</p>

<p>Bu arada <strong>knitr</strong>‘i her turlu farkli LaTeX <em>documentclass</em> icin kullanabilirsiniz, mesela rapor yazarken veya sunumunuzu hazirlarken. Diyelim ki sunumunuzdaki bir analizde kucuk bir degisiklik yapmak istiyorsunuz, artik cok kolay ve pratik bir sekilde bunu yapabilirsiniz.</p>

<h2 id="kapanis">Kapanis</h2>

<p>Daha once soyledigim gibi <strong>knitr</strong> bayagi flexible. Mesela LaTeX kullanmak istemiyorsaniz, <strong>R</strong> + <strong>Markdown</strong> + <strong>Rstudio</strong> da gayet guzel bir alternatif sizin icin. Boylece HTML ve ya Word output da elde edebilirsiniz, PDF in yaninda (ozellikle  LaTeX bilmiyorsaniz). Veyahut <strong>R</strong> yerine <strong>Phyton</strong>, <strong>SAS</strong>, <strong>Ruby</strong> kullanabilirsiniz, <strong>Rstudio</strong> yerine <strong>LyX</strong>, <strong>Texmaker</strong> veya <strong>Emacs</strong> kullanabilirsiniz. Fakat bence <strong>Rstudio</strong> dan sasmamak en mantiklisi cunku Rstudio knitr icin <em>build-in support</em> a sahip. Muhtemelen bunun onemli bir nedeni <strong>knitr</strong> in yaraticisinin bir <strong>Rstudio</strong> calisani olmasi. Hepsi ve daha fazlasi icin <a href="http://yihui.name/knitr/"><strong>knitr</strong> in websitesine bakabilirsiniz</a>. Son olarak, bu yazinin kendisi de <strong>knitr</strong> kullanarak reproducible researche bir ornek, source code u yazardan taleb edebilirsiniz.</p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog//2016/10/26/how-I-got-here.html">
        How I got here?
      </a>
    </h1>
    
<a href="/blog/2016/10/26/how-I-got-here.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">26 Oct 2016</span>

    <p>As someone with zero experience writing blogpost etc., <a href="https://github.com/yihui/knitr-jekyll">Yihui Xie’s minimal example</a> and <a href="http://statistics.rainandrhino.org/knitr-hyde/2015/12/12/sample-post.html">this sample blog</a> helped me a lot to start blogging. Normally, it can be quite tedious to work with a Jekyll-based blog for someone like me. However, Yihui’s servr R package facilitate how to build a <a href="https://jekyllrb.com/">Jekyll</a> website which uses <a href="yihui.name/knitr/">knitr</a> and Rmarkdown. By the way, I wanted to use Jekyll because I want to include R code to my blog posts. Also, I was lucky and I had experience with knitr and Rmarkdown before. Finally, with the help of Rstudio, the road for blogging with Jekyll is open for many more R users, I believe!</p>

  </div>
  
</div>

    </div>

  </body>
</html>
